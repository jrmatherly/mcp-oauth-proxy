{
  "metadata": {
    "project_name": "mcp-oauth-proxy",
    "generated": "2026-01-15T19:57:45Z",
    "version": "1.0.0",
    "language": "Go",
    "go_version": "1.25.0",
    "project_type": "OAuth 2.1 Authorization Server + MCP Proxy"
  },
  "stats": {
    "total_go_files": 32,
    "source_files": 24,
    "test_files": 8,
    "packages": 9,
    "documentation_files": 5,
    "documentation_lines": 2900
  },
  "entry_points": {
    "main": {
      "file": "main.go",
      "package": "main",
      "purpose": "Application bootstrap"
    },
    "cli": {
      "file": "cmd/root.go",
      "package": "github.com/obot-platform/mcp-oauth-proxy/cmd",
      "command": "mcp-oauth-proxy"
    },
    "tests": {
      "integration": "main_test.go",
      "unit": "pkg/*/test.go",
      "scripts": [
        "run_tests.sh",
        "test.sh",
        "test_oauth.sh",
        "test_sqlite_ci.sh"
      ]
    }
  },
  "packages": {
    "proxy": {
      "path": "pkg/proxy",
      "files": ["proxy.go", "proxy_test.go"],
      "exports": [
        "OAuthProxy",
        "NewOAuthProxy",
        "Start",
        "SetupRoutes",
        "GetHandler"
      ],
      "purpose": "HTTP server, CORS, rate limiting, MCP request proxying",
      "constants": ["ModeProxy", "ModeForwardAuth", "ModeMiddleware"]
    },
    "oauth": {
      "path": "pkg/oauth",
      "subpackages": {
        "authorize": {
          "file": "authorize.go",
          "exports": ["Handler", "NewHandler", "AuthorizationStore"],
          "purpose": "Authorization endpoint (/oauth/authorize)",
          "features": ["PKCE support", "client validation", "provider redirect"]
        },
        "token": {
          "file": "token.go",
          "exports": ["Handler", "NewHandler", "TokenStore"],
          "purpose": "Token endpoint (/oauth/token)",
          "grant_types": ["authorization_code", "refresh_token"]
        },
        "callback": {
          "file": "callback.go",
          "exports": ["Handler", "NewHandler", "Store", "MCPUIManager"],
          "purpose": "OAuth provider callback (/oauth/callback)"
        },
        "revoke": {
          "file": "revoke.go",
          "exports": ["Handler", "NewHandler", "Store"],
          "purpose": "Token revocation (/oauth/revoke)"
        },
        "register": {
          "file": "register.go",
          "exports": ["Handler", "NewHandler", "ClientStore"],
          "purpose": "Dynamic client registration (/oauth/register, RFC 7591)"
        },
        "validate": {
          "file": "validatetoken.go",
          "purpose": "Token validation utilities"
        },
        "success": {
          "file": "success.go",
          "purpose": "Success page handler"
        }
      }
    },
    "db": {
      "path": "pkg/db",
      "files": ["db.go", "db_test.go", "sqlite_test.go"],
      "exports": ["Store", "New"],
      "methods": {
        "client": ["GetClient", "StoreClient"],
        "grant": ["StoreGrant", "UpdateGrant", "GetGrant"],
        "token": ["StoreToken", "GetToken", "RevokeToken"],
        "auth_code": ["StoreAuthCode", "ValidateAuthCode", "DeleteAuthCode"],
        "cleanup": ["CleanupExpiredTokens", "CleanupExpiredAuthRequests"]
      },
      "purpose": "Database abstraction (PostgreSQL/SQLite via GORM)",
      "supports": ["PostgreSQL", "SQLite"]
    },
    "providers": {
      "path": "pkg/providers",
      "files": [
        "provider.go",
        "generic.go",
        "manager.go",
        "provider_test.go",
        "generic_test.go"
      ],
      "exports": ["Provider", "GenericProvider", "ProviderManager"],
      "methods": [
        "GetAuthorizationURL",
        "ExchangeCodeForToken",
        "GetUserInfo",
        "RefreshToken",
        "GetJWKS"
      ],
      "purpose": "OAuth 2.0 provider integration with auto-discovery",
      "supported_providers": [
        "Google",
        "Microsoft",
        "GitHub",
        "Any OAuth 2.0 provider"
      ]
    },
    "tokens": {
      "path": "pkg/tokens",
      "files": ["manager.go", "apikey.go", "manager_test.go", "apikey_test.go"],
      "exports": ["TokenManager", "NewTokenManager"],
      "methods": [
        "GenerateToken",
        "ValidateToken",
        "GenerateAPIKey",
        "ValidateAPIKey"
      ],
      "purpose": "JWT (RS256) token operations and API key auth",
      "features": [
        "RS256 signing",
        "JWKS endpoint",
        "Custom claims",
        "Token validation"
      ]
    },
    "types": {
      "path": "pkg/types",
      "files": ["types.go", "db_types.go", "oauth_types.go", "apikey_types.go"],
      "key_types": [
        "Config",
        "ClientInfo",
        "Grant",
        "TokenData",
        "AuthRequest",
        "OAuthError",
        "AuthorizationCode",
        "StoredAuthRequest"
      ],
      "purpose": "Shared data structures across packages"
    },
    "encryption": {
      "path": "pkg/encryption",
      "files": ["encryption.go", "random.go"],
      "exports": [
        "Encrypt",
        "Decrypt",
        "GenerateRandomString",
        "GenerateCodeChallenge"
      ],
      "purpose": "Cryptographic operations (AES-256-GCM, PKCE)"
    },
    "handlerutils": {
      "path": "pkg/handlerutils",
      "files": ["handlerutils.go"],
      "exports": ["JSON", "Error"],
      "purpose": "HTTP handler utilities and response formatting"
    },
    "ratelimit": {
      "path": "pkg/ratelimit",
      "files": ["ratelimiter.go"],
      "exports": ["RateLimiter", "NewRateLimiter"],
      "purpose": "IP-based rate limiting with token bucket algorithm"
    }
  },
  "dependencies": {
    "core": {
      "github.com/spf13/cobra": {
        "version": "v1.7.0",
        "purpose": "CLI framework"
      },
      "gorm.io/gorm": {
        "version": "v1.30.1",
        "purpose": "ORM framework"
      },
      "gorm.io/driver/postgres": {
        "version": "v1.6.0",
        "purpose": "PostgreSQL driver"
      },
      "github.com/glebarez/sqlite": {
        "version": "v1.11.0",
        "purpose": "SQLite driver (CGO-free)"
      }
    },
    "oauth_security": {
      "golang.org/x/oauth2": {
        "version": "v0.30.0",
        "purpose": "OAuth 2.0 client"
      },
      "github.com/golang-jwt/jwt/v5": {
        "version": "v5.3.0",
        "purpose": "JWT operations"
      },
      "github.com/MicahParks/keyfunc/v3": {
        "version": "v3.7.0",
        "purpose": "JWT key functions"
      }
    },
    "http": {
      "github.com/gorilla/handlers": {
        "version": "v1.5.2",
        "purpose": "HTTP middleware (CORS)"
      }
    },
    "testing": {
      "github.com/stretchr/testify": {
        "version": "v1.10.0",
        "purpose": "Testing assertions"
      }
    }
  },
  "documentation": {
    "main_docs": {
      "API_REFERENCE.md": {
        "lines": 483,
        "purpose": "Complete API endpoint reference"
      },
      "ARCHITECTURE.md": {
        "lines": 581,
        "purpose": "System architecture and design"
      },
      "DATABASE_SCHEMA.md": {
        "lines": 597,
        "purpose": "Database schema and data models"
      },
      "DEVELOPMENT.md": {
        "lines": 806,
        "purpose": "Development guide and workflows"
      },
      "INDEX.md": {
        "lines": 402,
        "purpose": "Documentation navigation hub"
      }
    },
    "root_docs": {
      "README.md": "Project overview, quick start",
      "TESTING.md": "Test suite documentation",
      "DOCUMENTATION_SUMMARY.md": "Documentation overview"
    }
  },
  "api_endpoints": {
    "oauth": [
      {
        "method": "GET|POST",
        "path": "/oauth/authorize",
        "purpose": "Authorization endpoint"
      },
      {
        "method": "POST",
        "path": "/oauth/token",
        "purpose": "Token endpoint (auth code, refresh)"
      },
      {
        "method": "GET",
        "path": "/oauth/callback",
        "purpose": "OAuth provider callback"
      },
      {
        "method": "POST",
        "path": "/oauth/revoke",
        "purpose": "Token revocation"
      },
      {
        "method": "POST",
        "path": "/oauth/register",
        "purpose": "Dynamic client registration"
      }
    ],
    "metadata": [
      {
        "method": "GET",
        "path": "/.well-known/oauth-authorization-server",
        "purpose": "OAuth metadata (RFC 8414)"
      },
      {
        "method": "GET",
        "path": "/.well-known/oauth-protected-resource",
        "purpose": "Resource metadata (RFC 8705)"
      }
    ],
    "mcp": [
      {
        "method": "POST",
        "path": "/mcp/*",
        "purpose": "MCP request proxy (with token validation)"
      }
    ],
    "health": [
      {
        "method": "GET",
        "path": "/health",
        "purpose": "Health check"
      }
    ]
  },
  "environment_variables": {
    "required": {
      "OAUTH_CLIENT_ID": "OAuth client ID",
      "OAUTH_CLIENT_SECRET": "OAuth client secret",
      "OAUTH_AUTHORIZE_URL": "Provider base URL",
      "SCOPES_SUPPORTED": "Comma-separated scopes",
      "MCP_SERVER_URL": "Backend MCP server URL",
      "ENCRYPTION_KEY": "Base64-encoded 32-byte AES key"
    },
    "optional": {
      "DATABASE_DSN": {
        "default": "SQLite",
        "description": "PostgreSQL connection string"
      },
      "PORT": {
        "default": "8080",
        "description": "HTTP server port"
      },
      "HOST": {
        "default": "localhost",
        "description": "HTTP server host"
      },
      "LOG_LEVEL": {
        "default": "info",
        "description": "Logging level"
      }
    }
  },
  "testing": {
    "categories": [
      {
        "name": "Unit Tests",
        "flag": "-short",
        "files": ["*_test.go"],
        "command": "make test-short"
      },
      {
        "name": "Integration Tests",
        "files": ["main_test.go", "pkg/db/db_test.go"],
        "command": "make test-integration",
        "requires": "PostgreSQL"
      },
      {
        "name": "Mock Provider Tests",
        "files": ["pkg/providers/*_test.go"],
        "command": "make test"
      }
    ],
    "coverage_goals": {
      "overall": ">80%",
      "critical_paths": ">95%",
      "database_layer": ">90%",
      "handler_layer": ">85%"
    }
  },
  "commands": {
    "development": {
      "test-short": "Run unit tests",
      "test": "Run all tests",
      "build": "Build binary",
      "demo-sqlite": "Run SQLite demo"
    },
    "quality": {
      "fmt": "Format code",
      "vet": "Vet code",
      "lint": "Run linter",
      "ci": "Run all checks"
    },
    "docker": {
      "docker-build": "Build image",
      "docker-run": "Run container"
    },
    "database": {
      "setup-test-db": "Start PostgreSQL test DB",
      "clean-test-db": "Stop test DB"
    }
  },
  "token_efficiency": {
    "index_size_kb": 5,
    "index_tokens": 3000,
    "full_codebase_tokens": 58000,
    "savings_percent": 94,
    "roi_sessions": 1
  },
  "repository": {
    "url": "https://github.com/obot-platform/mcp-oauth-proxy",
    "license": "Apache-2.0",
    "issues": "https://github.com/obot-platform/mcp-oauth-proxy/issues",
    "releases": "https://github.com/obot-platform/mcp-oauth-proxy/releases"
  }
}
